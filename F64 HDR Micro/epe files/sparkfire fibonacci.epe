{
  "name": "sparkfire fibonacci",
  "id": "zLg5az7iJ2sgEtzH4",
  "sources": {
    "main": "/*\n  Sparkfire\n  \n  What happens when you allow a pattern like 'sparks' to heat the air around it?\n  You get spark fire! It's probably a good idea to read through the comments on\n  'sparks' first.\n\n  Depending on the number of pixels in your strip, you may need to adjust the\n  first few variables to your liking; While there's meant to\n  mostly work depending on the number of pixels, you should tune them to look\n  good on your setup.\n*/\n\n// Number of sparks. Try 3-6.\nnumSparks = 3 + floor(pixelCount / 80)  \n\n// Subtractive cooling. Try 0.02..0.3. Higher cools faster.\ncooling1 = .05\n\n// Coefficient cooling. Try 0.9..0.995. Lower cools faster.\ncooling2 = .8 + 0.2 / (1 + exp(-pixelCount/80))\naccel = .03    // How much sparks accelerate as they rise (try 0.02..0.05)\nspeed = .05    // Baseline speed of travel for each spark (try 0.03..0.1)\n\n// Energy of each spark. Affects pixel heating and spark speed.\nsparks = array(numSparks)\nsparkX = array(numSparks)  // X position of each spark, in units of pixel index\nexport var pixels = array(pixelCount) // Brightness (heat energy) of each pixel\n\n// Initialize sparks with random position and energy\nfor (i = 0; i < numSparks; i++) {\n  sparkX[i] = random(pixelCount)\n  // Further sparks are older and have less energy\n  sparks[i] = .2 * (1 - sparkX[i] / pixelCount) + random(.4)\n}\n\n// Set up an initial heat value so init doesn't look empty\npixels[0] = 20\n\n\nexport function beforeRender(delta) {\n  delta *= speed // Scale the time between loops by speed.\n\n  for(i = 0; i < pixelCount; i++) {\n    // When more time has passed, more subtractive cooling occurs\n    cooldown = cooling1 * delta\n   \n    if(cooldown > pixels[i]) {\n      pixels[i] = 0\n    } else {\n      // Coefficient cooling (`cooling2`) makes hotter sparks lose more energy.\n      // Subtractive cooling makes all sparks lose some energy.\n      pixels[i] = pixels[i] * cooling2 - cooldown\n    }\n  }\n  /*\n    Heat rises. Starting at the far end and working towards the first pixel,\n    compute a weighted average of the heat from the preceding pixels and apply\n    it to this one. Weighting several pixels behind higher creates a nice wispy\n    pattern that can be seen more clearly by turning down `speed`.\n  */\n  for (k = pixelCount - 1; k >= 4; k--) {\n      h1 = pixels[k - 1]\n      h2 = pixels[k - 2]\n      h3 = pixels[k - 3]\n      h4 = pixels[k - 4]\n      pixels[k] = (h1 + h2 + h3 * 2 + h4 * 3) / 7\n    }\n  \n  for (i = 0; i < numSparks; i++) {\n    // Reinitialize a spark that's passed the end and been reset\n    if (sparks[i] <= 0) {\n      sparks[i] = random(1)\n      sparkX[i] = 0\n    }\n\n    // Accelerate (add kinetic energy) to each spark\n    sparks[i] += accel * delta\n    \n    // Stash the original x position of this spark \n    ox = sparkX[i]\n\n    // Δd = r·Δt \n    // Sparks advance at a rate that's the square of their energy\n    sparkX[i] += sparks[i] * sparks[i] * delta\n\n    // Reset sparks that are past the end\n    if (sparkX[i] > pixelCount) {\n      sparkX[i] = 0\n      sparks[i] = 0\n      continue  // Skip the rest of the for() loop for this iteration\n    }\n    \n    /*\n      For all pixels between the new x position and the original x position,\n      heat the pixels (add brightness). Higher energy sparks are travelling\n      faster and thus don't heat each pixel of air as much.\n    */\n    for (j = ox; j < sparkX[i]; j++)\n      pixels[j] += clamp(1 - sparks[i] * .4, 0 , 1) * .5\n  }\n}\n\nphysicalToFibonacci = [ 0, 13, 26, 39, 52, 57, 44, 31, 18, 5, 10, 23, 36, 49, 62, 54, 41, 28, 15, 2, 7, 20, 33, 46, 59, 51, 38, 25, 12, 4, 17, 30, 43, 56, 61, 48, 35, 22, 9, 1, 14, 27, 40, 53, 58, 45, 32, 19, 6, 11, 24, 37, 50, 63, 55, 42, 29, 16, 3, 8, 21, 34, 47, 60 ];\n\nexport function render(index) {\n  v = pixels[physicalToFibonacci[index]]\n\n  /*\n    v * v is our typical gamma correction, and it's constrained to remain\n    between 0 and 1. Multiplying this by 0.1 keeps us in the red-yellow range;\n    higher energies will be yellow.\n  */\n  h = .1 * clamp(v * v, 0, 1) \n  \n  /*\n    Desaturate (to white) any pixel with energy values between 1 and 1.5;\n    Saturation will be clamped to 0 for any energy value above 1.5. Without\n    this, the hottest pixels are just yellow instead of white hot.\n  */\n  s = 1 - (v - 1) * 2\n\n  // It's useful to remember that HSV clamps s and v for us to within 0..1\n  hsv(h, s, v)\n}\n"
  },
  "preview": "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"
}